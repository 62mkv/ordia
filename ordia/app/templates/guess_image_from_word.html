{% extends "base.html" %}


{% block scripts %}
{{super()}}

	<script type="text/javascript">
	 function sparqlDataToSimpleData(response) {
	     // Convert long JSON data from from SPARQL endpoint to short form
	     let data = response.results.bindings;
	     let columns = response.head.vars
	     var convertedData = [];
	     for (var i = 0 ; i < data.length ; i++) {
		 var convertedRow = {};
		 for (var key in data[i]) {
		     convertedRow[key] = data[i][key]['value'];
		 }
		 convertedData.push(convertedRow);
	     }
	     console.log(convertedData);
	     return {data: convertedData, columns: columns};
	 }

	 function initialize() {
	     sessionStorage.ordiaGuessImageFromWord = {
		 score: 0,
		 lexemeData: {},
	     };
	 };

	 function newGame() {
	     console.log('newGame');
	     sessionStorage.ordiaGuessImageFromWord = {score: 0};

	     $("#score").text("0");
	     $("#word").text("agurk");

	     sparql = `
              SELECT * {
                ?lexeme wikibase:lemma ?lemma ;
                        dct:language wd:Q9035 ;
                        ontolex:sense / wdt:P18 ?image .
              } 
	     `;
	     
	     var url = "https://query.wikidata.org/sparql?query=" + 
		       encodeURIComponent(sparql) + '&format=json';
	     
	     $.getJSON(url, function(response) {
		 sessionStorage.ordiaGuessImageFromWord = {
		     score: 0,
		     lexemeData: sparqlDataToSimpleData(response),
		 };
		 presentPair();
	     });
	 };
	 
	 function presentPair() {
	     console.log('presentPair');
	     lexemeData = sessionStorage.ordiaGuessImageFromWord.lexemeData;
	     console.log(lexemeData);
	     
	 };
	 
	 function userChoice(choice) {
	     console.log(choice)
	 };

	 $(document).ready(function() {
	     initialize();
	 });
	</script>

 {% endblock %}

 {% block page_content %}
	
	<h1>Guess image from word</h1>

	<div class="container">

	    <div class="row justify-content-md-center text-center">
		<div class="col-sm-4">
		    <div class="form-group">
			<button type="button" class="btn btn-primary" onclick="newGame();">New game</button>
			<select class="btn btn-primary" id="language-selector" name="language">
			    <option value="da" selected="selected">Dansk</option>
			    <option value="de">Deutsch</option>
			    <option value="en">English</option>
			</select>
		    </div>
		</div>
	    </div>

	    <div class="row">
		<div class="progress">
		    <div class="progress-bar bg-success" role="progressbar" style="width: 30%" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100"></div>
		    <div class="progress-bar bg-info" role="progressbar" style="width: 20%" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100"></div>
		</div>
	    </div>

	    <div class="row">
		<div id="score" class="col-xl-2 justify-content-md-center text-center">
		    
		</div>
	    </div>

	    <div class="row">
		<div id="word" class="col-xl-12 justify-content-md-center text-center"">
		    tomat
		</div>
	    </div>


	    <div class="row justify-content-md-center">
		<div class="col-sm-3 text-center">
		    <button type="button" class="btn btn-lg"
			    onclick="userChoice('left');">
			<img id="left-image" height="200"
			     src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/88/Bright_red_tomato_and_cross_section02.jpg/200px-Bright_red_tomato_and_cross_section02.jpg"
/>
		    </button>
		</div>
		<div class="col-sm-3">
		    <button type="button" class="btn btn-lg"
			    onclick="userChoice('right');">
			<img id="right-image" height="200"
			     src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e6/126p_beige_jaslo.JPG/200px-126p_beige_jaslo.JPG"/>
		    </button>
		</div>
	    </div>
	</div>

{% endblock %}
